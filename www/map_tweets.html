<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Sistema de Monitoreo de Sismos en Twitter</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Monitoreo de Sismos">
<meta name="author" content="Felipe Bravo">

<script
	src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script
	src="https://maps.googleapis.com/maps/api/js?sensor=false&libraries=visualization"></script>

<!-- Le styles -->
<link href="css/bootstrap.css" rel="stylesheet">
<style>
body {
	padding-top: 60px;
	/* 60px to make the container go all the way to the bottom of the topbar */
}
</style>
<link href="css/bootstrap-responsive.css" rel="stylesheet">

<!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
<!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

<!-- Fav and touch icons -->

<script>
	// To get the value of the since parameter
	function GetURLParameter(sParam) {
		var sPageURL = window.location.search.substring(1);
		var sURLVariables = sPageURL.split('&');
		for ( var i = 0; i < sURLVariables.length; i++) {
			var sParameterName = sURLVariables[i].split('=');
			if (sParameterName[0] == sParam) {
				return sParameterName[1];
			}
		}
	}
</script>


<script>
	var myCenter = new google.maps.LatLng(-37, -69);

	function initialize() {
		var mapProp = {
			center : myCenter,
			zoom : 4,
			mapTypeId : google.maps.MapTypeId.ROADMAP
		};

		var map = new google.maps.Map(document.getElementById("googleMap"),
				mapProp);	
		
		$.getJSON("retrieve.php", { since : GetURLParameter('since') },  function(results) {
			//alert(results.tweets[0].text);        
			$.each(results.tweets, function(i, field) {
				var latLng = new google.maps.LatLng(field.lat, field.long);
				var marker = new google.maps.Marker({
					position : latLng,
					title : field.text+" "+field.date,
					map : map
				});
				if (field.neu == -1)
					marker.setIcon("img/smiley_sad");
				else if (field.neu == 1)
					marker.setIcon("img/smiley_happy");
				else
					marker.setIcon("img/smiley_neutral");

			});
		});

	}

	google.maps.event.addDomListener(window, 'load', initialize);
</script>



</head>

<body>

	<div class="navbar navbar-inverse navbar-fixed-top">
		<div class="navbar-inner">
			<div class="container">
				<button type="button" class="btn btn-navbar" data-toggle="collapse"
					data-target=".nav-collapse">
					<span class="icon-bar"></span> <span class="icon-bar"></span> <span
						class="icon-bar"></span>
				</button>
				<a class="brand" href="home.html">Monitor Sísmico Social</a>
				<div class="nav-collapse collapse">
					<ul class="nav">
						<li><a href="home.html">Home</a></li>

						<li class="dropdown"><a href="map_tweets.html"
							class="dropdown-toggle" data-toggle="dropdown">Mapa de Tweets <b class="caret"></b>
						</a>
							<ul class="dropdown-menu">
								<li><a href="map_tweets.html?since=1">Última hora</a></li>
								<li><a href="map_tweets.html?since=24">Último día</a></li>
								<li><a href="map_tweets.html?since=48">Últimos dos
										días</a></li>
								<li><a href="map_tweets.html?since=0">Todos los
										Tweets</a></li>
	
							</ul></li>

						<li class="dropdown"><a href="check_tweets.html"
							class="dropdown-toggle" data-toggle="dropdown">Chequear
								Tweets <b class="caret"></b>
						</a>
							<ul class="dropdown-menu">
								<li><a href="check_tweets.html?since=1">Última hora</a></li>
								<li><a href="check_tweets.html?since=24">Último día</a></li>
								<li><a href="check_tweets.html?since=48">Últimos dos
										días</a></li>
								<li><a href="check_tweets.html?since=0">Todos los
										Tweets</a></li>
							</ul></li>
					</ul>
				</div>
				<!--/.nav-collapse -->
			</div>
		</div>
	</div>

	<div class="container">

		<h1>Mapa de Tweets</h1>
		<div id="googleMap"
			style="width: 700px; height: 600px; margin-left: auto; margin-right: auto;"></div>
	</div>
	<!-- /container -->






	<script type="text/javascript" src="js/bootstrap-dropdown.js"></script>
	<script type="text/javascript">
		$(document).ready(function() {
			$('.dropdown-toggle').dropdown();
		});
	</script>



</body>
</html>